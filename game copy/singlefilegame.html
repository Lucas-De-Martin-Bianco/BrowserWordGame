<!DOCTYPE html>
<html>
<head>
    <title>Word Festival</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <style>
        /* Your CSS styles here */
        #scoreboard {
            height: 100%;
            width: 250px;
            position: fixed;
            top: 0;
            left: 0;
            background-color: #f4e5c6;
            padding-top: 15px;
        }

        /* Custom styles for the sidebar */
        #settingsbar {
            position: fixed;
            top: 0;
            right: -250px; /* Initially hidden */
            width: 250px;
            height: 100%;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }

        #settingsbar.active {
            right: 0; /* Display when active */
        }

        #bomb { display: block; margin: auto; }
        #fuse { display: block; margin: auto; }
        #word { display: block; margin: auto; }

        .custom-width {
            width: 10%;
            max-width: 200px; /* Set a maximum width if needed */
            margin: 0 auto; /* Center horizontally */
        }
    </style>

</head>
<body>
    <button id="settingsbarCollapse" class="btn btn-info" style="position: fixed; top: 10px; right: 260px">Settings</button>
    
    <div class="container-fluid">

        <div class="row">
            <!-- Scoreboard -->
            <div class="col-3 sidebar" id="scoreboard">
                <h2>Highscores</h2>
                <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Streak: N/A
                        <span class="badge text-bg-primary rounded-pill">run #N/A</span>
                    </li>
                  </ul>
            </div>
          
            <!-- Main Content -->
            <div class="col" style="margin-top: 20vh;">
                <div style="position: relative;">
                    <img id="bomb" src="bomb.png" style="width: 300px;">
                    <button id="startButton" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);" type="button" class="btn btn-success">Start</button>
                </div>
                <br>
                <div class="input-group mb-3 custom-width">
                    <input id="wordInput" type="text" class="form-control" placeholder="word" onkeyup="handleKeyPress(event)">
                </div>      
                <br>
                <h1 id="scorecount" class="text-center">0</h1>
            </div>

            <!-- Settingsbar -->
            <div id="settingsbar">
                <h2>Settings</h2>
                <p1>Language</p1>
                <div class="btn-group" role="group">
                    <input type="radio" class="btn-check" name="btnlang" id="btnlang1" autocomplete="off" checked>
                    <label class="btn btn-outline-primary" for="btnlang1">German</label>
                  
                    <input type="radio" class="btn-check" name="btnlang" id="btnlang2" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnlang2">English</label>
                </div>
                <br>
                <p1>Fuse Time</p1><br>
                <input type="range" value="5" min="1" max="15" oninput="this.nextElementSibling.value = this.value" id="fuseTime">
                <output>5</output>

                <label for="life_select">Amount of Lifes</label>
                <select class="form-select" id="life_select">
                    <option value="1">1</option>
                    <option value="2" selected>2</option>
                    <option value="3">3</option>
                </select>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Get elements
            var settingsbar = document.getElementById("settingsbar");
            var toggleSettingsbar = document.getElementById("settingsbarCollapse");
            // Toggle settingsbar on button click
            toggleSettingsbar.addEventListener("click", function () {
                if (settingsbar.classList.contains("active")) {
                    settingsbar.classList.remove("active");
                } else {
                    settingsbar.classList.add("active");
                }
            });
        });
        // check for enter key
        function handleKeyPress(event) {
            if (event.keyCode === 13) {
                checkWord();
            }
        }

        function checkWord() {
            var word = document.getElementById('wordInput').value;
            if (word.length > 0) {
                    document.getElementById('wordInput').value = '';
                    searching(word);
            }
        }

        function searching(word) {
            let url = `https://api.dictionaryapi.dev/api/v2/entries/en/${word}`
            fetch(url)
            .then((response) => response.json())
            .then((result) => checkingword(result,word))
        }

        function checkingword(result,word) {
            if (result[0] && result[0].hasOwnProperty('word') && result[0].phonetics.length !== 0) {
                resetTimer()
                document.getElementById("scorecount").textContent = parseInt(document.getElementById("scorecount").textContent) + 1
            } 
            else {
                    document.getElementById('bomb').src = 'bomb_explode.png';
                    setTimeout(function() {
                    document.getElementById('bomb').src = 'bomb_ticking.png';
                    }, 2000);
                    document.getElementById("scorecount").textContent = 0
            }
        }


        //gameplay logic
        document.addEventListener('DOMContentLoaded', function() {
            // Get the button elements
            const wordInput = document.getElementById('wordInput');
            const startButton = document.getElementById('startButton');
            // Add click event listener to the control button
            startButton.addEventListener('click', () => {
                startButton.style.display = 'none';
                //focus the textinput
                wordInput.focus();
                //disable settings menu
                if (settingsbar.classList.contains("active")) {
                    settingsbar.classList.remove("active");
                }
                document.getElementById("settingsbarCollapse").disabled = true;
                //change png
                document.getElementById('bomb').src = 'bomb_ticking.png';
                resetTimer()
            });
        });

        let countdown;
        const fuseTimeInput = document.getElementById('fuseTime');

        function resetTimer() {
            clearInterval(countdown); // Stop the current countdown
            let seconds = parseFloat(fuseTimeInput.value) + 0.25; // Get the new value and add 0.5
            countdown = setInterval(function() {
                seconds--;
                if (seconds >= 1) {
                    console.log(seconds);
                } else {
                    clearInterval(countdown);
                    //console.log("timer done");
                    // Disable the input field
                    document.getElementById('wordInput').disabled = true;
                    // Clear the input field's value
                    document.getElementById('wordInput').value = '';
                    console.log(document.getElementById("scorecount").textContent)
                    document.getElementById('bomb').src = 'bomb_explode.png';
                    document.getElementById("scorecount").textContent = 0;
                    document.getElementById("settingsbarCollapse").disabled = false;
                    setTimeout(function() {
                        document.getElementById('bomb').src = 'bomb_ticking.png';
                        startButton.style.display = 'block';
                    }, 2000);
                    
                }
            }, 1000);
        }
    </script>

</body>
</html>
